<%! import urllib %>
<%inherit file="/base-tree.html" />
<%namespace name="entity" file="/entity/entity.html" />
<%def name="head()">
<script src="/js/eval.js" type="text/javascript"></script>
<script src="/js/admin.js" type="text/javascript"></script>
<script src="/js/tabnav.js" type="text/javascript"></script>
<script src="/js/entity.js" type="text/javascript"></script>
</%def>

## Header
<%def name="title()">Thinker - ${c.entity.label}</%def>
<%def name="head_title()">${c.entity.label}</%def>


## Body
<h1 id="label">${h.titlecase(c.entity.label)}</h1>
%if c.entity.sep_dir:
<p><a href="http://plato.stanford.edu/entries/${c.entity.sep_dir}/" target="_blank"><img src="/img/sepmanicon.png" /> ${h.titlecase(c.entity.label)}</a> is also an article in the Stanford Encyclopedia of Philosophy.</p>
%endif
%if c.entity.wiki:
<p><a href="http://wikipedia.org/wiki/${c.entity.wiki.decode('utf-8')}" target="_blank"><img src="/img/wikiicon.png" /> ${h.titlecase(c.entity.label)}</a> also has a Wikipedia article.</p>
%endif


<p><a href="http://philpapers.org/s/${c.entity.label.replace(' ', '%20')}"> <img src="/img/pp.gif"/> ${h.titlecase(c.entity.label)}</a> can be searched on PhilPapers.</p>


<ul class="nav nav-tabs" id="tabnav" data-tabs="tabs">
    <li id="home-tab" class="active"><a href="#home" data-toggle="tab"><i class="icon-home"></i></a></li>
    %if h.auth.is_admin():
    <li id="admin-tab"><a href="#admin" data-toggle="tab"><i class="icon-pencil"></i> Admin </a></li>
    %endif
</ul>



<div class="tab-content" id="tabnav-content">
    <div class="tab-pane active" id="home">
      <dl class="dl-horizontal">
          %if c.entity.birth_dates:
          <dt>Birth Dates:</dt>
          %for date in c.entity.birth_dates:
          <dd>
          ${date}
          </dd>
          %endfor
          %endif
      
          %if c.entity.death_dates:
          <dt>Death Dates:</dt>
          %for date in c.entity.death_dates:
          <dd>
          ${date}
          </dd>
          %endfor
          %endif

          %if len(c.entity.nationalities):
          <dt>Nationality/ethnicity:</dt>
          %for nationality in c.entity.nationalities:
          <dd>${nationality.name}</dd>
          %endfor
          %endif
      
          %if len(c.entity.professions):
          <dt>Profession:</dt>
          %for profession in c.entity.professions:
          <dd>${profession.name}</dd>
          %endfor
          %endif
      
          %if len(c.entity.aliases):
          <dt>Alias:</dt>
          %for alias in c.entity.aliases:
          <dd>${alias}</dd>
          %endfor
          %endif
      </dl>

      ${entity.printList('influenced', type="thinker", method='manual')}
      ${entity.printList('influenced_by', type="thinker", method='manual')}
      ${entity.printList('students', type="thinker", method='manual')}
      ${entity.printList('teachers', type="thinker", method='manual')}
      ${entity.printList('related', 'Related Thinkers', method='statistical', type="thinker")}
      ${entity.printList('related_ideas', 'Related Terms', method='statistical', type="thinker")}

%if not (c.entity.influenced[:10] or c.entity.influenced_by[:10] or c.entity.related[:10] or c.entity.related_ideas[:10] or c.entity.teachers[:10] or c.entity.students[:10]):
${entity.printMissing()}
%endif
    </div>
## If user is authorised, show admin panel
%if h.auth.is_admin():
    <div class="tab-pane" id="admin">
${entity.printAdminPanel(["id", "label", "sep_dir", "searchstring", "wiki", "searchpatterns", "birth", "death", "influenced_by", "influenced", "teachers", "students"])}
    </div>
%endif
</div> <!-- tab-content -->


<script type="text/javascript">
		
		//Width and height
			var w = 300;
			var h = 200;
			
		//Initialize a default force layout, using the nodes and edges in dataset
			var force = d3.layout.force()
								 .size([w, h])
								 .linkDistance([50])
								 .charge([-100]);

			var colors = d3.scale.category10();

			//Create SVG element
			var svg = d3.select("body")
						.insert("svg",["#container"])
						.attr("width", w)
						.attr("height", h)
						.style("position","absolute");
						
			//Load json file		
			d3.json("/js/d3/d3_thinker.json", function(error,graph) {
			console.log(graph);
			force
				.links(graph.links)
				.nodes(graph.nodes) 
				.start();
			
			//Create edges as lines
			var edges = svg.selectAll("line")
				.data(graph.links)
				.enter()
				.append("line")
				.style("stroke", "#ccc")
				.style("stroke-width", 1);
			
			//Create nodes as circles
			var nodes = svg.selectAll("circle")
				.data(graph.nodes)
				.enter()
				.append("circle")
				.attr("r", 10)
				.attr("data-toggle", "tooltip")
				.attr("title","Test")
				.style("fill", function(d, i) {
					return colors(i);
				})
				.call(force.drag);

			
			//Every time the simulation "ticks", this will be called
			force.on("tick", function() {
    				edges.attr("x1", function(d) { return d.source.x; })
	        		.attr("y1", function(d) { return d.source.y; })
        			.attr("x2", function(d) { return d.target.x; })
	        		.attr("y2", function(d) { return d.target.y; });

    				nodes.attr("cx", function(d) { return d.x; })
        			.attr("cy", function(d) { return d.y; });
  });
});
  


		</script>